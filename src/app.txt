<script setup lang="ts">
import { ipcMain } from 'electron'
import {ref} from 'vue'

const input1 = ref('')

const status = ref('')

const startFind = async (name: string) => {
  const newName = ref('')
  console.log('finding')
  console.log(name)
  if (name.startsWith('npm find:')){
    status.value = 'npm'
    newName.value = name.replace('npm find:', '').trim()
    const result = await window.ipcRenderer.invoke('get-package-intel', newName.value)
    console.log(result)
    return result
  }
  
  if (name.startsWith('deep npm find:')){
    status.value = 'dnpm'
    newName.value = name.replace('deep npm find:', '').trim()
    const result = await window.ipcRenderer.invoke('get-package-intel-deep', newName.value)
    console.log(result)
    return result
  }
  
  if (name.startsWith('python find:')){
    status.value = 'py'
    newName.value = name.replace('python find:', '').trim()
    const result = await window.ipcRenderer.invoke('get-pypi-intel', newName.value)
    console.log(result)
    return result
  }
  
  if (name.startsWith('deep python find:')){
    status.value = 'dpy'
    newName.value = name.replace('deep python find:', '').trim()
    const result = await window.ipcRenderer.invoke('get-pypi-intel-deep', newName.value)
    console.log(result)
    return result
  }
  
  if (name.startsWith('cpp find:')){
    status.value = 'cpp'
    newName.value = name.replace('cpp find:', '').trim()
    const result = await window.ipcRenderer.invoke('get-cpp-intel', newName.value)
    console.log(result)
    return result
  }
}

</script>

<template>
  <div id="main">
    <div id="logo" class="">
    </div>
    <div id="content-space" v-show="status === 'npm'">
      <div id="npm">
        <div id="base" class="returns">
          <p id="author"></p>
          <p id="keywords"></p>
        </div>
        <div id="links" class="returns">
          <p id="homepage"></p>
          <p id="repository"></p>
          <p id="bugs"></p>
          <p id="npm"></p>
        </div>
        <div id="people" class="returns"></div>
        <div id="security" class="returns"></div>
      </div>
    </div>
    <div id="command-area">
      <input type="text" placeholder="Usage: find:package-name" spellcheck="false" v-model="input1" @keydown.enter="startFind(input1)"/>
    </div>
  </div>
</template>

<style scoped>
#main {
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  overflow: hidden;
  box-sizing: border-box;
  padding: 1vh;
  gap: 1vh;
}

#content-space {
  display: flex;
  /* background-color: blue; */
  width: 100%;
  height: 92%;
  box-sizing: border-box;
  overflow: hidden;
}

#command-area {
  box-sizing: border-box;
  overflow: hidden;
  height: 7%;
  width: 100%;
  display: flex;
  background-color: #1a1a1c;
  padding: 1vh;
  border-radius: 1vh;
}

#command-area > input {
  background-color: #ffffff15;
  outline: none;
  border: none;
  width: 100%;
  height: 100%;
  box-sizing: border-box;
  overflow: hidden;
  display: flex;
  border-radius: 0.5vh;
  color: white;
  padding: 0 1.5vh;
  font-size: 2.2vh;
  font-weight: 500;
}

#logo {
  display: flex;
  background-image: url('../logo.png');
  width: 100%;
  height: 5vh;
  box-sizing: border-box;
  background-repeat: no-repeat;
  overflow: hidden;
}
</style>